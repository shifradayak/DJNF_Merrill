---
title: "ct_env_spills"
output: html_document
date: "2024-06-02"
editor_options: 
  markdown: 
    wrap: sentence
---

## STORY PITCH

**Shifra Dayak, [shifrandayak\@gmail.com](mailto:shifrandayak@gmail.com){.email}, 202-215-7408**

**06/03/2024**

What the story's about: This story is about trends in reported environmental spills from the 1960s until now in Connecticut.
The story will examine how and why spills have changed over the years, and — zooming in on approximately the last 10 years — what places and people have been the most impacted by spills and why, as well as what implications those impacts and any follow-ups on the part of regulatory and response authorities have on environmental justice.

Why now: Environmental spills are fairly common and ongoing in Connecticut, with a [recent oil spill](https://www.nbcconnecticut.com/news/local/i-91-south-closed-enfield-oil-spill/3269785/) closing down part of a major interstate highway, [sewage](https://www.courant.com/2023/12/18/ct-towns-have-seen-nearly-150-sewage-spills-this-year-see-where-why-and-whats-being-done/) spilling into waterways in the last year and more, so telling this story now can help contextualize those recent spills and inform audiences in Connecticut about how environmental hazards (or the lack thereof) in their communities fit into larger historical patterns/

Three sources: For this story, I can interview Lori Saliby, the director of the state environment department's emergency response and spill prevention division, for context on how spill reporting works and why we might be seeing some of the trends that appear in this dataset.
I'd also reach out to state and local politicians in Connecticut that have been involved in environmental advocacy, some of whom are listed as part of the [Center for Climate Integrity](https://climateintegrity.org/leaders).
In Hartford, which has seen the most spills per a chloropeth map at the end of this file, CCI lists at least six politicians.
Finally, I'd want to talk to a few residents in places that have experienced spills — what have their experiences been like?
Do they feel that the cleanup and response process was adequate and took their community into account?
Did the spill(s) impact their health?
Ideally, at least a couple of these residents would be from places that have experienced high spill rates.

Potential impact: This story could help communities that have faced environmental hazards and injustice be brought to the forefront.
If, through reporting, a lack of action on responding to these reported spills is exposed, the story could help remedy that and spark action from regulatory and response authorities.

Three things that surprised/interested me: First, reported spills peaked in 2001.
In the analysis section of this markdown, there's some exploration of what could have contributed to this, including tying in historical context about changing state hazardous waste regulations in late 2001 and 2002, as well as anxiety about anthrax during the 2001 attacks.
I'd like to talk to some of the above sources to see if these theories are true, and if not, why else spills have declined steadily since then.
Second, while the top spill substances have relatively remained the same over the years, the share involving fuel oil has dropped significantly overtime.
I'd like to know why that is.
Third, there's a lot of variation between where the most spills have happened and where the highest rates of spills have been.
Looking at just raw numbers shows patterns that line up with other environmental injustice maps, which point to central and southwestern Connecticut as facing lots of issues.
But looking at per-1,000 rates shows us some random towns here and there that have seen disproportionate spills, which is surprising.

Context: The Connecticut Courant reported at the end of 2023 on [sewage spills](https://www.courant.com/2023/12/18/ct-towns-have-seen-nearly-150-sewage-spills-this-year-see-where-why-and-whats-being-done/) during the year and how they impacted waterways in the state.
Most sewage-related spills are because of outdated sewer systems, according to the piece — an issue that the state's environment department is working to remedy.
That's the most overarching spill-related reporting recently.
Other stories have largely been about individual incidents and have mostly covered breaking news, rather than trends or implications of spills.
But Connecticut Public reported last year on a new [environmental justice screening tool](https://www.ctpublic.org/news/2023-07-26/this-new-map-shows-which-ct-communities-are-hardest-hit-by-environmental-hazards) for Connecticut that shows what communities and census tracts are most heavily impacted by environmental injustices.
Notably, the map tool itself shows that the [most hard-hit communities](https://connecticut.maps.arcgis.com/apps/webappviewer/index.html?id=5adac07c27db40bbabc193af58634e5a) approximately line up with the parts of the state that have seen the most spills reported from 2010 until now.

Visuals: Data visualizations could include charts of spills over time and spills broken down by type across the years, and maps of where the most spills have occurred in Connecticut per 1,000 residents.
I'd also like to create a point map visualization showing where some of the spills from multiple-time offender companies occurred, possibly layered on top of regional data showing income levels or non-white population percentage in different cities and towns.
This will help readers draw conclusions about whether spills are more common in certain parts of Connecticut.
Photo and video could include visuals of places that have been impacted by spills, like the coastline in a southwestern Connecticut town or a site in Hartford where a spill was reported in the last decade.
I'd also like to create a behind-the-scenes video showing how I analyzed some of the data and created some of the visualizations.

Other information to gather: Perspectives from experts on what's caused the decline in spill reports since 2001 could be helpful.
Also, I want to look into any confounding factors that could have changed how spills have been reported throughout history, like reporting requirements becoming more or less stringent with different state administrations.
In addition to the data analysis below, I also want to look more into the following things with the dataset: if certain types of spills are more common in certain places, what the response record and rate for spills has been like (if responses varied by time or by town), how trends in spills across the state might have changed overtime in terms of what towns have been most impacted, if there are particular companies or actors that are responsible for a disproportionate number of spills.
For context, I'll also need to gather information on why spills in certain towns might be more prominent — are there manufacturing facilities, shipping routes or the like in certain spaces that make spills common?
I'd also like to look into legal action related to any of these spills or actors, and what the outcome of litigation has been, if any.

Estimated delivery: Mid-July 2024

## CLEANING, ANALYZING AND VISUALIZING THE DATA

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(janitor)
library(lubridate)
library(ggplot2)
```

```{r}
#Loading CSV and standardizing column header names
spills <- read_csv("spills.csv") |>
  clean_names()
```

```{r}
#Taking out 2024 because not enough data has been recorded yet, and then grouping by year to calculate how many spills reported per year
spills_by_year <- spills |>
  filter (year != "2024") |>
  group_by(year) |>
  summarise (
    spill_number = n()
  )

spills_by_year
```

```{r}
#Exporting the new grouped table
spills_by_year |> write_csv("spills_by_year.csv")
```

[Charting this](https://public.flourish.studio/visualisation/18240536/) shows us that spills peaked in 2001 and have been on a relatively steady decline since then, despite some minor variation from year to year.
This led me to take a brief look at the top year in particular.

```{r}
#Looking at 2001, because most spills happened then 
spills_2001_by_date <- spills |>
  filter (year == "2001") |> 
  group_by (release_date_and_time) |>
  summarise(
    count = n()
  ) |>
  filter (count > 1) |>
  arrange(desc(count))

#Examining the top date with the most spills reported in 2001
spills_individual_2001 <- spills |>
  filter (year == "2001", release_date_and_time == "10/16/2001 12:00:00 AM")

#Examining the nature/type of reports in 2001 at a glance
spill_types_2001 <- spills |>
  filter (year == "2001") |>
  group_by(release_substance) |>
  summarise (
    reports_by_substance = n()
  ) |> 
  arrange(desc(reports_by_substance))

```

There probably is not much to look at with any particular incidents in 2001 specifically, as indicated by the data — even though there were a lot of spill reports on the top day (the day with the most reports), they all seem to be from different places/incidents, so it's not like there was one big incident that we need to look at in-depth.

I did research to see if there are any driving factors for the steady drop after the peak in 2001.
It looks like there were three rounds of changes to Connecticut's hazardous waste management laws from October 2001 to September 2002, which aligned state laws with federal hazardous waste management standards.
It's a little bit counterintuitive, because these legislative changes largely REDUCED the management requirements for certain types of hazardous waste — but when thinking about it, this could have led to the decline in reports, since less stringent management means less need for reporting.
This is the opposite of how stricter requirements could have led to a decline (more strict requirements could have reduced the actual number of spills).

Of course, the reason why the number of reports declined could, in fact, be from fewer spills themselves.
We're not sure from the data alone what the driving factor is, but both could be possible explanations.
From a regulatory perspective, these reforms also included some changes to corrective action guidelines (in line with the EPA's federal reforms to the Resource Conservation and Recovery Act, which deals with hazardous waste cleanup), but this probably didn't affect the reporting numbers much, since this dataset deals purely with total reports and not what happens after.

The last chunk of code above shows us that fuel oil, antifreeze and transformer oil were the top substances spilled in 2001.
I'm curious what the biggest types of spills recorded in this dataset overall have been, outside of just 2021.

```{r}
spills_by_type <- spills |>
  group_by(release_substance) |>
  summarise (
    substance_type = n()
  ) |>
  arrange(desc(substance_type))
  
```

Grouping by release substance (above) confirms that those same three substances have made up the most spills across all years in this dataset.
Now, let's break this down further and group by substance type and year, to see how some of the top substances spilled may vary across this dataset.
One possible hole: the way that substances are reported in this dataset is very non-standardized, so these numbers could be undercounting the actual number of spills in each substance category.
For instance, most fuel oil spills are written as "#2 FUEL OIL," but some may be written as "#2 fuel oil" and thus not counted.
Cleaning the data and then redoing this count will make it more accurate, but this is just a rough estimate.

```{r}
#Fuel oil 
fuel_oil <- spills |> 
  filter(release_substance == "#2 FUEL OIL") |>
  group_by (year) |>
  summarise (
    fuel_oil = n()
  ) |>
  arrange(year)

#Antifreeze
antifreeze <- spills |> 
  filter(release_substance == "ANTIFREEZE") |>
  group_by (year) |>
  summarise (
    antifreeze = n()
  ) |>
  arrange(year)

#Transformer oil
transformer_oil <- spills |> 
  filter(release_substance == "TRANSFORMER OIL") |>
  group_by (year) |>
  summarise (
    transformer_oil = n()
  ) |>
  arrange(year)

#Gasoline 
gasoline <- spills |> 
  filter(release_substance == "GASOLINE") |>
  group_by (year) |>
  summarise (
    gasoline = n()
  ) |>
  arrange(year)

#Diesel fuel 
diesel_fuel <- spills |> 
  filter(release_substance == "DIESEL FUEL") |>
  group_by (year) |>
  summarise (
    diesel_fuel = n()
  ) |>
  arrange(year)

#Joining all of these 
substance_dfs <- list(antifreeze, diesel_fuel, fuel_oil, gasoline, transformer_oil)

substances_across_years <-reduce(substance_dfs, left_join, by = "year")

#Calculating the numbers as a percentage of all spills 
substances_pct_total <- substances_across_years |>
 inner_join(spills_by_year, by=c("year")) |>
  rename (total_spills = spill_number) |>
  mutate (antifreeze = (antifreeze/total_spills)*100, 
          diesel_fuel = (diesel_fuel/total_spills)*100,
          fuel_oil = (fuel_oil/total_spills)*100,
          gasoline = (gasoline/total_spills)*100,
          transformer_oil = (transformer_oil/total_spills)*100
          )

#Renaming column names for more clarity 
substances_pct_total <- substances_pct_total |>
  rename (
    antifreeze_pct = antifreeze, 
    diesel_fuel_pct = diesel_fuel, 
    fuel_oil_pct = fuel_oil, 
    gasoline_pct = gasoline, 
    transformer_oil_pct = transformer_oil
  )

#Exporting
substances_pct_total |>
  write_csv("substances_pct_total.csv")

```

When we [chart by substance by year](https://public.flourish.studio/visualisation/18242246/), we can see that patterns have remained relatively the same — except for fuel oil, which no longer makes up as large a share of total reported spills as it used to.
There were some years where antifreeze and transformer oil also peaked, making up the biggest share of spills.
Possible reasons for these variations could be another interesting thing to ask sources about.

Going back to 2001, I also want to zoom in on one particular category of substances.
One big factor that could have caused the peak in that year is the 2001 anthrax scare.

As compared to the year immediately following (2002), a bigger chunk of all spills reported in 2001 seem to be related to anthrax or anthrax scares, with keywords like "powder" and "white substance." See below for the code I used to figure that out:

```{r}
#Filtering for relevant release substance, then calculating the percentage of those that make up the total reports in 2001

spill_types_2001 |>
  mutate(total_reports = sum(reports_by_substance)) |>
  filter(str_detect(release_substance, "WHITE | SUSPICIOUS | ANTHRAX")) |>
  mutate(total_anthrax_related_pct = (sum(reports_by_substance))/total_reports*100)
  
```

```{r}
#Doing the same thing for 2002, to see if anthrax was less of a concern in that year

spill_types_2002 <- spills |>
  filter (year == "2002") |>
  group_by(release_substance) |>
  summarise (
    reports_by_substance = n()
  ) |> 
  arrange(desc(reports_by_substance))

spill_types_2002 |>
  mutate(total_reports = sum(reports_by_substance)) |>
  filter(str_detect(release_substance, "WHITE | SUSPICIOUS | ANTHRAX")) |>
  mutate(total_anthrax_related_pct = (sum(reports_by_substance))/total_reports*100)

```

We can see that anthrax-related reports in 2001 made up more than 5 percent of total reports that year, whereas anthrax-related reports in 2002 made up just over 1 percent of total reports that year, showing a significant difference and lending support to the hypothesis that anthrax reports drove at least part of the massive peak in 2001 reports.

Let's move on to grouping by place, to see if there are trends in where spills have been reported.
To narrow down the scope, let's look at roughly the last decade of recorded data (2010 and after).

```{r}

#Filtering for 2010 and after
after_2010_spills <- spills |>
  filter (year > 2009)

#Standardizing stylization of place names 
after_2010_spills$town_of_release <- toupper(after_2010_spills$town_of_release)


#Cleaning up some messy/wrong names 
after_2010_spills <- after_2010_spills |>
  mutate(
    town_of_release = case_when (
      town_of_release == "GRONTON" ~ "GROTON",
      town_of_release == "GROTOM" ~ "GROTON",
      town_of_release == "MIFORD" ~ "MILFORD",
      town_of_release == "MILLFORD" ~ "MILFORD",
      town_of_release == "MONTOVILLE" ~ "MONTVILLE",
      town_of_release == "OOLD SAYBROOK" ~ "OLD SAYBROOK",
      town_of_release == "WATERTOWM" ~ "WATERTOWN",
      town_of_release == "NORTHFORD" ~ "NORTH BRANFORD",
      .default = town_of_release
    )
  )

#Grouping by place 
spills_by_town <- after_2010_spills |>
  group_by (town_of_release) |>
  summarise (
    reports_by_town = n()
  ) |>
  arrange(desc(reports_by_town)) |>
  slice(1:170)

#Exporting as CSV so we can map in Flourish  
spills_by_town |>
  write_csv("spills_by_town.csv")
  


```

To clean up the data by town (in the chunk of code above), I cross-compared with name keys in a GeoJSON file of Connecticut municipalities, and took out any instances of towns that didn't correspond to the shapefile data (or spills that had no town attached to them).

Here's the [resulting map](https://public.flourish.studio/visualisation/18244615/) I created on Flourish of spills by town.
More spills were reported from towns in central Connecticut and southwestern Connecticut.

That's just with raw numbers.
To see what the impact on people is, we can further expand this map by normalizing the number of spills per 1,000 residents in each town.

```{r}
#Reading in and joining a table that has populations for each town 
town_populations <- read_csv("pop_towns2022.csv") |>
  clean_names () |>
  rename (town_of_release = town)

#Making joining easier by getting rid of the N/A row in the spills by town table and renaming
spills_by_town <- spills_by_town |>
  arrange(town_of_release)

#Joining and calculating spills per 1000 people
spills_per_thousand <- spills_by_town |>
 inner_join(town_populations, by=c("town_of_release")) |>
  mutate (per_thousand_spill_rate = (reports_by_town/population)*1000) |>
  arrange(desc(per_thousand_spill_rate))

#Exporting 
spills_per_thousand |> write_csv("spills_per_thousand.csv")
```

Here's a [map](https://public.flourish.studio/visualisation/18244185/) that shows those results charted.

```{r, results='asis'}
cat ('<div class="flourish-embed flourish-map" data-src="visualisation/18244185"><script src="https://public.flourish.studio/resources/embed.js"></script></div>')

```

The patterns look different — the southwestern and central towns that saw the largest numbers of spills didn't necessarily see the highest spill rates.
The highest rates were spread out across the state, with Franklin, Stafford and Bloomfield at the top of the list.
This would be another interesting thing to ask sources about.
Why are there so many spills in these places, relative to the number of people who live there?
Some higher rates make sense — Groton, for instance, is home to a large U.S.
Navy submarine contracting company.
But others, like Franklin (a small rural town) might point to some hidden answers.
